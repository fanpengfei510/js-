## 第四章 表达式和运算符
> 表达式(expression)javascript中的一个短语，javascript解析器会将其计算处一个结果。  
> 变量也是一种简单的表达式，它的值就是复制给变量的值。  
> 复杂表达式是由简单表达式组成的。  
> 表达式由一个表示函数对象的表达式和0个或多个参数表达式构成。  

### 4.1 原始表达式
> 最简单的表达式是：原始表达式。  
> 原始表达式是表达式的最小单位---他们不在包含其他表达式。
> js中的原始表达式包含常量或直接量、关键字和变量。  

``` javascript
// 直接量
1.23;       // 数字直接量
"hello";    // 字符串直接量
/pattern/;  // 正则表达式直接量

// js中保留字构成了原始表达式
true;       // 布尔值：真
false;      // 布尔值：假
null;       // 返回一个空值
/*
和其他关键字不同，this并不是一个常量，它在程序的不同地方返回的值也不相同
this关键字经常在面向对象编程中出现
在一个方法体内，this返回调用这个方法的对象
*/
this;       // 返回当前对象

// 原始表达式是变量
i;          // 返回变量i的值
sum;        // 返回num的值
undefined;  // undefined是全局变量，和null不同，他不是一个关键字
```

### 4.2 对象和数组的初始化表达式
> 对象和数组初始化表达式实际上是一个新创建的对象和数组。  
> 这些初始化表达式有时称作"对象直接量"和“数组直接量”。
> 然而和布尔值直接量不同，他们不是原始表达式，因为他们所包含的成员或者元素都是子表达式。  
``` javascript
/*
  初始化的结果是一个新创建的数组
*/
[];         // 一个空数组，没有任何元素
[1+2,3+4];  // 拥有两个元素的数组，第一个是3，第二个是7

// 这些表达式是可以嵌套的
var matrix = [[1,2,3],[4,5,6],[7,8,9]];

// 数组直接量中的列表都好之间的元素可以忽略，空位值为`undefined`
var arr = [1,,,4];      // [1,undefined,undefined,undefined,4]

/*
  对象初始化表达式和数组初始化类似，只是方括号编程花括号代替，并且每个子表达式都包含一个属性名和一个冒号做前缀
*/
var obj = { x:2.4, y:-12};    // 一个拥有两个属性成员的对象
var obj1 = {};                // 一个空对象
obj1.x = 2.4; obj1.y = -12;   // obj1的属性成员和obj的一样

// 对象直接量可以嵌套
var obj = {
  upperLeft : { x:2, y:2},
  lowerRight : { x:4, y:6}
};
```

### 4.3 函数定义表达式
> 函数定义表达式成为“函数直接量”，对象初始化表达式也称为“对象直接量”。
``` javascript
/*
  函数定义的方式
  1.函数定义表达式包含关键字function
  2.后面跟随一个对圆括号，括号内是一个以逗号分隔的列表，列表含有0或者多个形参
  3.最后是一对花括号，里面包含js代码段，函数体
*/
var square = function(x){
  return x * x;
}
```

### 4.4 属性访问表达式
> 属性访问表达式运算得到一个对象属性或一个数组的元素值。  
``` javascript
/*
  js为属性访问定义了两种语法
  1.第一种写法是一个表达式后边跟一个句号和标识符。
  2.第二种写法是使用反括号，方括号内是另一种表达式(这种方法适用于对象和数组)
*/
expression.identifier;
expression[expression];

/*
  不管使用那种形式的属性访问表达式，在“.”和“[”之前的表达式总是会首先计算。
  如果是null和undefined会报类型错误
  如果运算结果不是对象或数组，js会将其转换为对象
*/
var obj = { x:1, y:{ z:2 }};      // 一个示例对象
var obj1 = [obj,4,[5,6]];         // 一个包含这个对象的示例数组
obj.x;                            // => 1：表达式obj的x属性
obj.y.z;                          // => 3：表达式obj.y的z属性
obj["x"];                         // => 1：对象obj的x属性
obj1[1];                          // => 4：表达式obj1中索引为1的元素
obj1[2]["1"];                     // => 6：表达式obj1[2]中索引为1的元素
obj1[0].x;                        // => 1：表达式obj1[0]的x属性
```

### 4.5 调用表达式
> js的调用表达式是一种调用(或者执行)函数或方法的语法表示。  
> 它以一个函数表达式开始，这个函数表达式指代了要调用的函数。  
``` javascript
// 函数表达式后跟随一对圆括号，括号内是一个以都好隔开的参数列表，参数可以有0个或者多个
f(o);               // f是一个函数表达式，o是一个参数表达式
Math.max(x,y,z);    // Math.max是一个函数，x、y、z是参数
a.sort();           // a.sort是一个函数，没有参数
```
* 如果函数表达式的值不是一个可调用的对象，则抛出一个类型错误一场(所有的函数都是可被调用的，即使宿主对象不是函数他也由可能被调用)。
* 实参的值被一次赋值给形参，这些形参是定义函数时制定的，接下来开始执行函数体。
* 如果函数使用`return`语句给出一个返回值，那么这个返回值就是整个调用表达式的值，否则调用表达式的值就是undefined。
* 任何一个调用表达式都包含一对圆括号和左圆括号之间的表达式。
* 如果这个表达式是一个属性访问表达式，那么这个调用称作“方法调用”。
* 在方法调用中，执行函数体的时候，作用属性访问主题的对象和数组便是其调用方法内this的执行。这种特性是的在面向对象编程中，函数(其OO名称为“方法”)可以调用其宿主对象。

### 4.6 对象创建表达式
> 对象创建表达式(object creation expression)创建一个对象并调用一个函数(这个函数称作构造函数)初始化新对象的属性。  

``` javascript
// 对象创建之前多一个关键字“new”
new Object();
new Point(2,3);

// 如果不需要传入任何参数，括号可以忽略掉
new Object;
new Date;
```
* 当计算一个对象创建表达式的值时，和对象初始化表达式通过`{}`创建对象的做法一样，js受限创建一个新的空对象，然后，js通过传入制定的参数并将这个新对象当做`this`的值来调用一个指定的函数。
* 这个函数可以使用`this`来初始化这个新创建对象的属性。

### 4.7 运算符概念
> js中的运算符用于算数表达式、比较表达式、逻辑表达式、复制表达式等。  

* js运算符是按照运算符的优先级排序的，前面的运算符优先级高于后面的运算符优先级。
* 标题为A的列，表示运算符的结合性，L(从左至右)或R(从右至左)。
* 标题为N的列，表示操作数的个数。
* 标题为“类型”的列，表示期望的操作数类型，以及运算符的结果类型(在“→”符号之后)。

| 运算符 | 操作 | A | N | 类型 |
|-------|------|---|---|------|
| ++ | 前/后增量 | R | 1 | lval → num |
| -- | 前/后减量 | R | 1 | lval → num |
| - | 求反 | R | 1 | num → num |
| + | 转换为数字 | R | 1 | num → num |
| ~ | 按位求反 | R | 1 | int → int |
| ! | 逻辑非 | R | 1 | bool → bool |
| delete | 删除属性 | R | 1 | lval → lval |
| typeof | 检测操作数类型 | R | 1 | any → str |
| void | 返回undefined | R | 1 | any → undef |
| *、/、% | 乘、除、求余 | L | 2 | num,num → num |
| +、- | 加、减 | L | 2 | num,num → num |
| + | 字符串链接 | L | 2 | str,str → str |
| << | 左移位 | L | 2 | int,int → int |
| >> | 有符号右移 | L | 2 | int,int → int |
| >>> | 无符号右移 | L | 2 | int,int → int |
| <、<=、>、>= | 比较数字顺序 | L | 2 | num,num → bool |
| <、<=、>、>= | 比较在字母表中的顺序 | L | 2 | str,str → bool |
| instanceof | 测试对象类 | L | 2 | obj,func → bool |
| in | 测试属性是否存在 | L | 2 | str,obj → bool |
| == | 判断相等 | L | 2 | any,any → bool |
| != | 判断不等 | L | 2 | any,any → bool |
| === | 判断恒等 | L | 2 | any,any → bool |
| !== | 判断非恒等 | L | 2 | any,any → bool |
| & | 按位与 | L | 2 | int,int → int |
| ^ | 按位异或 | L | 2 | int,int → int |
| \| | 按位或 | L | 2 | int,int → int |
| && | 逻辑与 | L | 2 | any,any → any |
| \|\| | 逻辑或 | L | 2 | any,any → any |
| ?: | 条件运算符 | R | 3 | bool,any,any → any |
| = | 变量复制或对象属性赋值 | R | 2 | lval,any → any |
| *=、/=、%=、-=、&=、^=、\|=、<<=、>>=、>>>= | 运算且赋值 | R | 2 | lval,any → any |
| , | 忽略第一个操作数，返回第二个操作数 | L | 2 | any,any → any |